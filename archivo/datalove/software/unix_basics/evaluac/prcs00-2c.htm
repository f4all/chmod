<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
<HEAD>
	<TITLE></TITLE>
	<META NAME="GENERATOR" CONTENT="StarOffice/5.1 (Linux)">
	<META NAME="AUTHOR" CONTENT="Victor Gonzalez-Barbone">
	<META NAME="CREATED" CONTENT="20000724;9342600">
	<META NAME="CHANGEDBY" CONTENT="Victor Gonzalez-Barbone">
	<META NAME="CHANGED" CONTENT="20001214;7012100">
	<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=iso-8859-1">
	<STYLE>
	<!--
		@page { margin-left: 2cm; margin-right: 2cm; margin-top: 1.5cm; margin-bottom: 1.5cm }
		P { font-size: 11pt }
	-->
	</STYLE>
</HEAD>
<BODY BGCOLOR="#ffffff">
<ADDRESS>Centro de Inform&aacute;tica. Sistemas Operativos II. Curso
2000, reedici&oacute;n 2o. Semestre, versi&oacute;n &quot;c&quot;</ADDRESS>
<HR>
<H3 ALIGN=CENTER>Prueba parcial 2/2c - Soluciones</H3>
<P STYLE="margin-bottom: 0cm"><FONT SIZE=5>1.</FONT><FONT SIZE=2 STYLE="font-size: 11pt">
Escribir un script que reciba un nombre de m&aacute;quina y la busque
en el archivo /etc/hosts. Si la m&aacute;quina existe, devolver&aacute;
su n&uacute;mero IP; si no existe, emitir&aacute; un mensaje
adecuado. El di&aacute;logo tendr&aacute; esta forma:</FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT SIZE=2 STYLE="font-size: 11pt">Si
la m&aacute;quina existe:</FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT FACE="courier, monospace"><FONT SIZE=2 STYLE="font-size: 11pt">Resoluci&oacute;n
de n&uacute;mero IP.</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT FACE="courier, monospace"><FONT SIZE=2 STYLE="font-size: 11pt">Nombre
m&aacute;quina: ampere.iie.edu.uy</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT FACE="courier, monospace"><FONT SIZE=2 STYLE="font-size: 11pt">La
m&aacute;quina ampere.iie.edu.uy tiene n&uacute;mero IP 164.73.224.40</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT SIZE=2 STYLE="font-size: 11pt">Si
la m&aacute;quina no existe:</FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT FACE="courier, monospace"><FONT SIZE=2 STYLE="font-size: 11pt">Resoluci&oacute;n
de N&uacute;mero IP.</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT FACE="courier, monospace"><FONT SIZE=2 STYLE="font-size: 11pt">Nombre
m&aacute;quina: ampe</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT FACE="courier, monospace"><FONT SIZE=2 STYLE="font-size: 11pt">La
m&aacute;quina ampe no existe.</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT FACE="times, serif"><FONT SIZE=2 STYLE="font-size: 11pt">Recordar
que los caracteres de separaci&oacute;n en /etc/hosts pueden ser
espacios o tabuladores. El nombre de una m&aacute;quina debe ser una
palabra, no s&oacute;lo una cadena: en el ejemplo, la m&aacute;quina
ampe no existe, pero s&iacute; existe ampere. (15 puntos)</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT SIZE=2 STYLE="font-size: 11pt">&nbsp;</FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT SIZE=2 STYLE="font-size: 11pt">Estructura
del archivo /etc/hosts: </FONT>
</P>
<P STYLE="margin-bottom: 0cm"><FONT SIZE=3><TT><FONT SIZE=2 STYLE="font-size: 11pt"><FONT FACE="courier, monospace">#n&uacute;mero_IP
nombre_m&aacute;quina alias</FONT></FONT></TT><FONT SIZE=2 STYLE="font-size: 11pt"><FONT FACE="courier, monospace">
</FONT></FONT></FONT>
</P>
<P STYLE="margin-bottom: 0cm"><FONT SIZE=3><TT><FONT SIZE=2 STYLE="font-size: 11pt"><FONT FACE="courier, monospace">10.137.137.250&nbsp;&nbsp;&nbsp;
liebre.cdi.edu.uy liebre localhost mailhost</FONT></FONT></TT><FONT SIZE=2 STYLE="font-size: 11pt"><FONT FACE="courier, monospace">
</FONT></FONT></FONT>
</P>
<P STYLE="margin-bottom: 0cm"><FONT SIZE=2 STYLE="font-size: 11pt">&nbsp;</FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT FACE="courier, monospace"><FONT SIZE=2 STYLE="font-size: 11pt">#!/bin/bash</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT FACE="courier, monospace"><FONT SIZE=2 STYLE="font-size: 11pt">#
prob1: recibe nombre m&aacute;quina y devuelve n&uacute;mero IP.</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT FACE="courier, monospace"><FONT SIZE=2 STYLE="font-size: 11pt">#</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT FACE="courier, monospace"><FONT SIZE=2 STYLE="font-size: 11pt">echo
Resoluci&oacute;n de N&uacute;mero IP.</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT FACE="courier, monospace"><FONT SIZE=2 STYLE="font-size: 11pt">echo
-n &quot; Nombre m&aacute;quina: &quot;; read NOMBRE</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT FACE="courier, monospace"><FONT SIZE=2 STYLE="font-size: 11pt">IP=`grep
-w $NOMBRE /etc/hosts | tr &quot;\t&quot; &quot; &quot; | tr -s &quot;
&quot; | \</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT FACE="courier, monospace"><FONT SIZE=2 STYLE="font-size: 11pt">cut
-d &quot; &quot; -f1`</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT FACE="courier, monospace"><FONT SIZE=2 STYLE="font-size: 11pt">if
[ $IP ]</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT FACE="courier, monospace"><FONT SIZE=2 STYLE="font-size: 11pt">then</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT FACE="courier, monospace"><FONT SIZE=2 STYLE="font-size: 11pt">echo
&quot;La m&aacute;quina $NOMBRE tiene n&uacute;mero IP $IP&quot;</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT FACE="courier, monospace"><FONT SIZE=2 STYLE="font-size: 11pt">else</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT FACE="courier, monospace"><FONT SIZE=2 STYLE="font-size: 11pt">echo
&quot;La m&aacute;quina $NOMBRE no existe&quot;.</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT FACE="courier, monospace"><FONT SIZE=2 STYLE="font-size: 11pt">fi</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT SIZE=2 STYLE="font-size: 11pt">&nbsp;</FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT SIZE=5>2.</FONT> Los intentos
fallidos de login se registran con l&iacute;neas del tipo <BR><TT><FONT SIZE=2>&nbsp;&nbsp;Set
5 6:29:57 liebre login[486]: invalid password for `UNKNOWN' on
`ttyp2' from `tero'</FONT></TT> <BR><TT><FONT SIZE=2>&nbsp;&nbsp;Oct
11 16:33:48 liebre login[492]: invalid password for `victor' on
`ttyp2' from `liebre'</FONT></TT> <BR><TT><FONT SIZE=2>&nbsp;&nbsp;Dec
15 19:49:01 liebre login[492]: invalid password for `cristina' on
`ttyp2' from `nutria'</FONT></TT> <BR>en el archivo auth.log en el
directorio /var/log. Cuando este archivo se hace muy grande, se
aplica una rotaci&oacute;n de archivos que genera auth.log.0,
authlog.1.gz, auth.log.2.gz, ..., auth.log.9.gz. Los archivos
terminados en .gz est&aacute;n comprimidos, pero pueden visualizarse
con zcat, comando an&aacute;logo a cat. <BR>Construir un script que
examine todos los archivos auth.log* y emita un listado de nombres de
login fallidos (mensaje &quot;invalid password&quot;) y su cantidad,
en un listado del tipo <BR><TT>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 9
UNKNOWN</TT> <BR><TT>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 3 cristina</TT>
<BR><TT>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 6 root</TT> <BR><TT>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
3 victor</TT> <BR>(15 puntos). 
</P>
<P STYLE="margin-bottom: 0cm">&nbsp;&nbsp;</P>
<P STYLE="margin-bottom: 0cm"><TT>#!/bin/bash</TT> <BR><TT># prob2:
cuenta intentos de login fallidos.</TT> <BR><TT>#</TT> <BR><TT>zcat
/var/log/auth.log.?.gz | \</TT></P>
<P STYLE="margin-bottom: 0cm"><TT><TT>&nbsp; </TT>cat
/var/log/auth.log /var/log/auth.log.0 - | \</TT> <BR><TT>&nbsp; grep
&quot;invalid password&quot; | tr -s &quot; &quot; | cut -d &quot; &quot;
-f9 | \</TT> <BR><TT>&nbsp; sort | uniq -c | tr -d \`\'</TT> <BR>&nbsp;</P>
<P STYLE="margin-bottom: 0cm"><FONT SIZE=5>3.</FONT> La lista de
correos electr&oacute;nicos de interesados en recibir un bolet&iacute;n
mensual de novedades se encuentra en un archivo de este formato: <BR><TT>&nbsp;&nbsp;#
LISTA ENVIO BOLETIN ELECTRONICO</TT> <BR><TT>&nbsp;&nbsp;# nombre
alumno:direcci&oacute;n e-mail:situaci&oacute;n</TT> <BR><TT>&nbsp;&nbsp;Julio
P&eacute;rez:jperez@adinet.com.uy:enlista</TT> <BR><TT>&nbsp;&nbsp;Mariela
Lombardo::notiene</TT> <BR><TT>&nbsp;&nbsp;Ad&aacute;n
Paz:apaz@netgate.com.uy:noenvio</TT> <BR><TT>&nbsp;&nbsp;Gabriel
Gim&eacute;nez:ggime@multi.com.uy:enlista</TT> <BR>Las categor&iacute;as
son: <TT>enlista</TT> (desea recibir el bolet&iacute;n), <TT>noenvio</TT>
(no desea recibir el bolet&iacute;n),<TT> notiene</TT> (no tiene
correo electr&oacute;nico). Escribir un script que muestre cantidad y
porcentaje de cada categor&iacute;a. &iquest;Qu&eacute; modificaci&oacute;n
habr&iacute;a que hacer al script si no se conocen a priori los
nombres de las categor&iacute;as? (20 puntos).</P>
<P STYLE="margin-bottom: 0cm"><TT>&nbsp;</TT> <BR><TT>#!/bin/bash</TT>
<BR><TT># prob3: calcula cantidad y porcentaje en lista de env&iacute;o.</TT>
<BR><TT>#</TT> 
</P>
<P STYLE="margin-bottom: 0cm"><TT>echo</TT> <BR><TT>echo LISTA DE
ENVIO: cantidad y porcentaje por categor&iacute;as</TT> <BR><TT>echo
&quot;Categor&iacute;a&nbsp;&nbsp; Cantidad&nbsp;&nbsp;&nbsp; %&quot;</TT>
</P>
<P STYLE="margin-bottom: 0cm"><TT># calcula el total por n&uacute;mero
de l&iacute;neas</TT> <BR><TT>TOTAL=`cat listaenvio | grep -v &quot;#&quot;
| wc -l`</TT> 
</P>
<P STYLE="margin-bottom: 0cm"><TT># inicializa lista de categor&iacute;as</TT>
<BR><TT>CATEGORIAS=&quot;enlista noenvio notiene&quot;</TT> 
</P>
<P STYLE="margin-bottom: 0cm"><TT># calcula y presenta porcentajes</TT>
<BR><TT>for CAT in $CATEGORIAS</TT> <BR><TT>do</TT> <BR><TT>&nbsp;
echo -n &quot;$CAT&nbsp; &quot;</TT> <BR><TT>&nbsp; CANT=`cat
listaenvio | grep -v &quot;#&quot; | grep $CAT | wc -l`</TT> <BR><TT>&nbsp;
echo -n &quot;$CANT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &quot;</TT> <BR><TT>&nbsp;
echo `expr $CANT \* 100 / $TOTAL`\%</TT> 
</P>
<P STYLE="margin-bottom: 0cm"><TT>done</TT> <BR><TT>&nbsp;</TT> <BR><TT>###</TT>
<BR><TT># modificaci&oacute;n: si no se conocen a priori los nombres
de las categor&iacute;as:</TT> <BR><TT># CATEGORIAS=`cat listaenvio |
grep -v &quot;#&quot; | cut -d &quot;:&quot; -f3 | sort | uniq`</TT>
<BR><TT>###</TT> <BR>&nbsp;</P>
</BODY>
</HTML>